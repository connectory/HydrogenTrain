
<html>
	<head>
		<style>
			body{
					font-family: -apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
				}
			li  {
					border: 2px solid #e6e6e6;
					padding: 4px;
					margin: 3px;
					list-style-type: none;
				}
			a   {
					display: -webkit-box;
					display: -moz-box;
					display: -ms-flexbox;
					display: -webkit-flex;
					display: flex;
					align-items: center;
					justify-content: flex-start;
					text-decoration: none;
					color: grey;
				}
			h4   {
					margin-left: 2em; 
				}
						
			.pricetag   {
					margin: auto;
					margin-left: 25%;
					position: absolute;
					display: flex;
					align-items: center;
					vertical-align: center;
				}
			.pricetimeout   {
					margin: auto;
					margin-left: 50%;
					position: absolute;
					display: flex;
					align-items: center;
					vertical-align: center;
				}
			img {
					margin-left: 2em;
				}
		</style>
	</head>
	<script>
		var prices = {};
		var pricesTimeout = {};
		var lowestPriceTag = "Agip";
		
		function refreshAllPriceTags() {
			var lowestprice = 1000;
			var newLowestPriceTag = "Agip";
			
			//get prices
			readTextFile("./data/prices.json", function(text){
				var data = JSON.parse(text);
				prices = data;
				});
				
			//get timeout of prices
			readTextFile("./data/pricestimeout.json", function(text){
				var data = JSON.parse(text);
				pricesTimeout = data;
				});
			//refresh prices, timeouts and cheapest price
			for (var prop in prices) {
				if(prices[prop] <= lowestprice) {
					lowestprice = prices[prop];
					newLowestPriceTag = prop;
				}
				var newPriceTag = getPriceTag(prop);
				document.getElementById(prop).innerHTML = newPriceTag;
				var newPriceTimeout = getPriceTimeout(prop);
				document.getElementById(prop + "timeout").innerHTML = newPriceTimeout;
			}
			
			if(newLowestPriceTag != lowestPriceTag) {
				//change old element to standard grey
				document.getElementById(lowestPriceTag).parentElement.parentElement.style.border = "2px solid #e6e6e6";
				
				//change new lowest price element border to green
				lowestPriceTag = newLowestPriceTag;
				document.getElementById(lowestPriceTag).parentElement.parentElement.style.border = "2px solid #00991c";
			}
		}
		
		function getPriceTag(company) {
			return "Preis pro Liter: " + prices[company] + " bytes";
		}
		
		function getPriceTimeout(company) {
			return Math.round((pricesTimeout[company] / 1000)) + " sec";
		}
		
		function onLoad() {
			setInterval(refreshAllPriceTags, 100);
		}
		
		function readTextFile(file, callback) {
			var rawFile = new XMLHttpRequest();
			rawFile.overrideMimeType("application/json");
			rawFile.open("GET", file, true);
			rawFile.onreadystatechange = function() {
				if (rawFile.readyState === 4 && rawFile.status == "200") {
					callback(rawFile.responseText);
				}
			}
			rawFile.send(null);
		}

		
		
		
	</script>
	<body onload="onLoad()">
		<div>
			<ul>
				<li>
					<a href=#/><img title="Informationen" src="./img/agip.jpg" alt=Logo width=40 height=40> <h4>Agip</h4> <p class="pricetag" id="Agip"></p> <p class="pricetimeout" id="Agiptimeout"></p></a>
				</li>
				<li>
					<a href=#/><img title="Informationen" src="./img/aral.jpg" alt=Logo width=40 height=40> <h4>Aral</h4> <p class="pricetag" id="Aral"></p> <p class="pricetimeout" id="Araltimeout"></p></a>
				</li>
				<li>
					<a href=#/><img title="Informationen" src="./img/avia.jpg"alt=Logo width=40 height=40> <h4>Avia</h4> <p class="pricetag" id="Avia"></p> <p class="pricetimeout" id="Aviatimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/baywa.jpg"alt=Logo width=40 height=40> <h4>BayWa</h4> <p class="pricetag" id="BayWa"></p> <p class="pricetimeout" id="BayWatimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/bft.jpg"alt=Logo width=40 height=40> <h4>bft</h4> <p class="pricetag" id="bft"></p> <p class="pricetimeout" id="bfttimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/classic.jpg"alt=Logo width=40 height=40> <h4>Classic</h4> <p class="pricetag" id="Classic"></p> <p class="pricetimeout" id="Classictimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/ed.jpg"alt=Logo width=40 height=40> <h4>ED</h4> <p class="pricetag" id="ED"></p> <p class="pricetimeout" id="EDtimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/elan.jpg"alt=Logo width=40 height=40> <h4>Elan</h4> <p class="pricetag" id="Elan"></p> <p class="pricetimeout" id="Elantimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/esso.jpg"alt=Logo width=40 height=40> <h4>Esso</h4> <p class="pricetag" id="Esso"></p> <p class="pricetimeout" id="Essotimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/go.jpg"alt=Logo width=40 height=40> <h4>GO</h4> <p class="pricetag" id="GO"></p> <p class="pricetimeout" id="GOtimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/hem.jpg"alt=Logo width=40 height=40> <h4>HEM</h4> <p class="pricetag" id="HEM"></p> <p class="pricetimeout" id="HEMtimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/hoyer.jpg"alt=Logo width=40 height=40> <h4>Hoyer</h4> <p class="pricetag" id="Hoyer"></p> <p class="pricetimeout" id="Hoyertimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/jet.jpg"alt=Logo width=40 height=40> <h4>Jet</h4> <p class="pricetag" id="Jet"></p> <p class="pricetimeout" id="Jettimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/markant.jpg"alt=Logo width=40 height=40> <h4>Markant</h4> <p class="pricetag" id="Markant"></p> <p class="pricetimeout" id="Markanttimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/oil.jpg"alt=Logo width=40 height=40> <h4>Oil</h4> <p class="pricetag" id="Oil"></p> <p class="pricetimeout" id="Oiltimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/omv.jpg"alt=Logo width=40 height=40> <h4>Omv</h4> <p class="pricetag" id="Omv"></p> <p class="pricetimeout" id="Omvtimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/q1.jpg"alt=Logo width=40 height=40> <h4>Q1</h4> <p class="pricetag" id="Q1"></p> <p class="pricetimeout" id="Q1timeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/raiffeisen.jpg"alt=Logo width=40 height=40> <h4>Raiffeisen</h4> <p class="pricetag" id="Raiffeisen"></p> <p class="pricetimeout" id="Raiffeisentimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/shell.jpg"alt=Logo width=40 height=40> <h4>Shell</h4> <p class="pricetag" id="Shell"></p> <p class="pricetimeout" id="Shelltimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/sprint.jpg"alt=Logo width=40 height=40> <h4>Sprint</h4> <p class="pricetag" id="Sprint"></p> <p class="pricetimeout" id="Sprinttimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/star.jpg"alt=Logo width=40 height=40> <h4>Star</h4> <p class="pricetag" id="Star"></p> <p class="pricetimeout" id="Startimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/team.jpg"alt=Logo width=40 height=40> <h4>Team</h4> <p class="pricetag" id="Team"></p> <p class="pricetimeout" id="Teamtimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/total.jpg"alt=Logo width=40 height=40> <h4>Total</h4> <p class="pricetag" id="Total"></p> <p class="pricetimeout" id="Totaltimeout"></p></a>
				</li>
				<li>
					<a href=#/> <img title="Informationen" src="./img/westfalen.jpg"alt=Logo width=40 height=40> <h4>Westfalen</h4> <p class="pricetag" id="Westfalen"></p> <p class="pricetimeout" id="Westfalentimeout"></p></a>
				</li>
			</ul>
		</div>
	</body>
</html>